(()=>{"use strict";var e="";const t=e+"assets/0423e9054bbc9277b0347f38f82b6921.png";class n{constructor(){this._tooltips=[]}showTooltip(e,t){const n=document.createElement("DIV");n.classList.add("form-error"),n.textContent=e;const o=performance.now();this._tooltips.push({id:o,element:n}),document.body.appendChild(n);const{right:s,top:c}=t.getBoundingClientRect();return n.style.left=`${s+5}px`,n.style.top=c+t.offsetHeight/2-n.offsetHeight/2+"px",o}removeTooltip(e){const t=this._tooltips.find((t=>t.id===e));t&&t.element.remove(),this._tooltips=this._tooltips.filter((t=>t.id!==e))}}class o{constructor(){this.container=null,this.update=!1,this.activEvent=null}openPopup(e){if(!(e instanceof HTMLElement))throw new Error("container is not HTMLElement");if(this.container=e,!document.querySelector(".popup_container")){const e=document.createElement("DIV"),t=document.createElement("FORM"),s=document.createElement("DIV"),c=document.createElement("P"),r=document.createElement("INPUT"),a=document.createElement("DIV"),i=document.createElement("P"),d=document.createElement("INPUT"),l=document.createElement("DIV"),p=document.createElement("BUTTON"),u=document.createElement("BUTTON");t.setAttribute("novalidate",!0),e.classList.add("popup_container"),s.classList.add("popup-control"),a.classList.add("popup-control"),c.classList.add("Input_text"),c.textContent="Название",i.classList.add("Input_text"),i.textContent="Стоимость",r.classList.add("input_name"),r.setAttribute("required",!0),r.name="name",d.classList.add("input_cost"),d.setAttribute("required",!0),d.name="cost",d.pattern="^([0-9]*$)",l.classList.add("popup-btn"),p.classList.add("btn"),p.classList.add("btn_cancel"),p.textContent="Отмена",u.classList.add("btn"),u.classList.add("btn_save"),u.textContent="Сохранить",document.body.appendChild(e),e.prepend(t),l.prepend(p),l.prepend(u),t.prepend(l),a.prepend(d),a.prepend(i),t.prepend(a),s.prepend(r),s.prepend(c),t.prepend(s),p.addEventListener("click",(e=>{e.preventDefault(),o.closePopup()}));const m=new n;let _=[];const v=(e,t)=>{_.push({name:t.name,id:m.showTooltip(e,t)})};t.addEventListener("submit",(e=>{if(e.preventDefault(),_.forEach((e=>m.removeTooltip(e.id))),_=[],t.checkValidity()){if(this.update||(this.saveInputNote(),o.closePopup()),this.update){const e=this.activEvent.closest(".list_editor").querySelector(".name_title"),t=this.activEvent.closest(".list_editor").querySelector(".cost_title");e.textContent=r.value,t.textContent=d.value,this.update=!1,o.closePopup()}}else{const{elements:e}=t;[...e].forEach((e=>{const t=o.getError(e);t&&v(t,e)}))}}));const E=e=>{const t=e.target,n=o.getError(t);if(n)v(n,t);else{const e=_.find((e=>e.name===t.name));e&&m.removeTooltip(e.id)}t.removeEventListener("blur",E)};Array.from(t.elements).forEach((e=>e.addEventListener("focus",(()=>{e.addEventListener("blur",E)}))))}}static getError(e){const t=Object.keys(ValidityState.prototype).find((t=>e.name?"valid"===t?null:e.validity[t]:null));return t?{name:{valueMissing:"Представьтесь, пожалуйста!"},cost:{valueMissing:'Заполните, пожалуйста, поле "Стоимость"',patternMismatch:"Стоимость вы можете указать только цифрами"}}[e.name][t]:null}static closePopup(){document.querySelector(".popup_container").remove()}saveInputNote(){const e=document.querySelector(".input_name"),n=document.querySelector(".input_cost"),o=document.querySelector(".list_editor_container"),s=document.createElement("UL"),c=document.createElement("LI"),r=document.createElement("P"),a=document.createElement("LI"),i=document.createElement("P"),d=document.createElement("LI"),l=document.createElement("IMG"),p=document.createElement("DIV");s.classList.add("list_editor"),c.classList.add("name"),r.classList.add("name_title"),a.classList.add("cost"),i.classList.add("cost_title"),d.classList.add("action_edit"),l.classList.add("btn_update_img"),p.classList.add("btn_delete"),r.textContent=e.value,i.textContent=n.value,l.src=t,p.textContent="x",o.appendChild(s),d.prepend(p),d.prepend(l),s.prepend(d),a.prepend(i),s.prepend(a),c.prepend(r),s.prepend(c),l.addEventListener("click",(e=>{this.updateNote(l.closest(".list_editor")),this.activEvent=e.target})),p.addEventListener("click",(()=>p.closest(".list_editor").remove()))}updateNote(e){this.container?this.openPopup(this.container):(this.openPopup(document.querySelector(".app_container")),this.activEvent=document.querySelector(".btn_update_img"));const t=document.querySelector(".input_name"),n=document.querySelector(".input_cost");t.value=e.querySelector(".name_title").textContent,n.value=e.querySelector(".cost_title").textContent,this.update=!0}}const s=e+"assets/5aa6b32fc514efe1581dee5b8561fec9.jpg";console.log("app.js is bunled"),document.querySelector(".btn_update_img").src=t,document.querySelector(".container").style.backgroundImage=`url(${s})`;const c=document.querySelector(".btn_add"),r=document.querySelector(".btn_update_img"),a=document.querySelector(".btn_delete"),i=new o,d=document.querySelector(".app_container");c.addEventListener("click",(e=>{e.preventDefault(),i.openPopup(d)})),r.addEventListener("click",(()=>{i.updateNote(r.closest(".list_editor"))})),a.addEventListener("click",(()=>a.closest(".list_editor").remove()))})();
//# sourceMappingURL=main.js.map